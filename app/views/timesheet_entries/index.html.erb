<div class="page-header">
  <h1>Timesheet</h1>
</div>

<h2>Totals logged by person</h2>

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Who</th>
      <th>30 days</th>
      <th>13 weeks</th>
      <th>Hours logged this week</th>
      <th>28-day hours</th>
    </tr>
  </thead>
  <tbody>
<% @staff.each do |member| -%>
    <tr>
      <td><%= member.name %></td>
      <td class="numeric">
        <%= number_to_currency(amount_invoiced_by(member, 30), unit: '£') %>
        <small>
          (<%= number_to_currency(amount_invoiced_by(member, 30, 1), unit: '£') %> +
          <%= number_to_currency(amount_invoiced_by(member, 30, 0), unit: '£') %>)
        </small>
      </td>
      <td class="numeric">
        <%= number_to_currency(amount_invoiced_by(member, 91), unit: '£') %>
        <small>
          (<%= number_to_currency(amount_invoiced_by(member, 30, 1), unit: '£') %> +
          <%= number_to_currency(amount_invoiced_by(member, 30, 0), unit: '£') %>)
        </small>
      </td>
      <td>
        <%= hours_logged_this_week_by(member) %>
      </td>
      <td>
        <%= member.hours_logged_to_date(28) %>
      </td>
    </tr>
<% end -%>
  </tbody>
</table>

<h2>Recent entries</h2>

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      <th>Organisation</th>
      <th>When</th>
      <th>Description</th>
      <th>Value</th>
      <th>Time</th>
      <th>Who</th>
    </tr>
  </thead>
  <tbody>
<% @timesheet_entries.each do |e| -%>
    <tr>
      <td><%= link_to e.organisation.name, e.organisation %></td>
      <td><%= format_time(e.started_at) %></td>
      <td><%= e.description %></td>
      <td class="numeric"><%= number_to_currency(e.invoice_value, :unit => '£') %></td>
      <td class="numeric"><%= e.minutes %>m</td>
      <td><%= link_to e.user.name, e.user %></td>
    </tr>
<% end -%>
  </tbody>
</table>
